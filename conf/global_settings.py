import numpy as np

S4_cayley = [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23],
			 [1, 2, 3, 0, 7, 19, 11, 17, 23, 5, 6, 20, 15, 12, 13, 14, 9, 21, 22, 16, 10, 4, 8, 18],
			 [2, 3, 0, 1, 17, 16, 20, 21, 18, 19, 11, 10, 14, 15, 12, 13, 5, 4, 8, 9, 6, 7, 23, 22],
			 [3, 0, 1, 2, 21, 9, 10, 4, 22, 16, 20, 6, 13, 14, 15, 12, 19, 7, 23, 5, 11, 17, 18, 8],
			 [4, 22, 16, 10, 14, 0, 7, 8, 9, 6, 13, 1, 17, 23, 5, 11, 12, 2, 21, 18, 19, 20, 15, 3],
			 [5, 11, 17, 23, 0, 14, 9, 6, 7, 8, 3, 15, 16, 10, 4, 22, 2, 12, 19, 20, 21, 18, 1, 13],
			 [6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 0, 1, 2, 3, 4, 5],
			 [7, 8, 9, 6, 13, 1, 17, 23, 5, 11, 12, 2, 21, 18, 19, 20, 15, 3, 4, 22, 16, 10, 14, 0],
			 [8, 9, 6, 7, 23, 22, 2, 3, 0, 1, 17, 16, 20, 21, 18, 19, 11, 10, 14, 15, 12, 13, 5, 4],
			 [9, 6, 7, 8, 3, 15, 16, 10, 4, 22, 2, 12, 19, 20, 21, 18, 1, 13, 5, 11, 17, 23, 0, 14],
			 [10, 4, 22, 16, 20, 6, 13, 14, 15, 12, 19, 7, 23, 5, 11, 17, 18, 8, 3, 0, 1, 2, 21, 9],
			 [11, 17, 23, 5, 6, 20, 15, 12, 13, 14, 9, 21, 22, 16, 10, 4, 8, 18, 1, 2, 3, 0, 7, 19],
			 [12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11],
			 [13, 14, 15, 12, 19, 7, 23, 5, 11, 17, 18, 8, 3, 0, 1, 2, 21, 9, 10, 4, 22, 16, 20, 6],
			 [14, 15, 12, 13, 5, 4, 8, 9, 6, 7, 23, 22, 2, 3, 0, 1, 17, 16, 20, 21, 18, 19, 11, 10],
			 [15, 12, 13, 14, 9, 21, 22, 16, 10, 4, 8, 18, 1, 2, 3, 0, 7, 19, 11, 17, 23, 5, 6, 20],
			 [16, 10, 4, 22, 2, 12, 19, 20, 21, 18, 1, 13, 5, 11, 17, 23, 0, 14, 9, 6, 7, 8, 3, 15],
			 [17, 23, 5, 11, 12, 2, 21, 18, 19, 20, 15, 3, 4, 22, 16, 10, 14, 0, 7, 8, 9, 6, 13, 1],
			 [18, 19, 20, 21, 22, 23, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17],
			 [19, 20, 21, 18, 1, 13, 5, 11, 17, 23, 0, 14, 9, 6, 7, 8, 3, 15, 16, 10, 4, 22, 2, 12],
			 [20, 21, 18, 19, 11, 10, 14, 15, 12, 13, 5, 4, 8, 9, 6, 7, 23, 22, 2, 3, 0, 1, 17, 16],
			 [21, 18, 19, 20, 15, 3, 4, 22, 16, 10, 14, 0, 7, 8, 9, 6, 13, 1, 17, 23, 5, 11, 12, 2],
			 [22, 16, 10, 4, 8, 18, 1, 2, 3, 0, 7, 19, 11, 17, 23, 5, 6, 20, 15, 12, 13, 14, 9, 21],
			 [23, 5, 11, 17, 18, 8, 3, 0, 1, 2, 21, 9, 10, 4, 22, 16, 20, 6, 13, 14, 15, 12, 19, 7]]
S4_CAYLEY = np.transpose(np.array(S4_cayley))

P0 = [[[0, 0, 0], [0, 0, 0], [0, 0, 0]],
	  [[0, 0, 0], [0, 1, 0], [0, 0, 0]],
	  [[0, 0, 0], [0, 0, 0], [0, 0, 0]]]

PX = [[[0, 0, 0], [0, 0, 0], [0, 0, 0]],
	  [[0, 0, 0], [-1/2, 0, 1/2], [0, 0, 0]],
	  [[0, 0, 0], [0, 0, 0], [0, 0, 0]]]

PY = [[[0, 0, 0], [0, 0, 0], [0, 0, 0]],
	  [[0, -1/2, 0], [0, 0, 0], [0, 1/2, 0]],
	  [[0, 0, 0], [0, 0, 0], [0, 0, 0]]]

PZ = [[[0, 0, 0], [0, -1/2, 0], [0, 0, 0]],
	  [[0, 0, 0], [0, 0, 0], [0, 0, 0]],
	  [[0, 0, 0], [0, 1/2, 0], [0, 0, 0]]]

PXX = [[[0, 0, 0], [0, 0, 0], [0, 0, 0]],
	  [[0, 0, 0], [1, -2, 1], [0, 0, 0]],
	  [[0, 0, 0], [0, 0, 0], [0, 0, 0]]]

PXY = [[[0, 0, 0], [0, 0, 0], [0, 0, 0]],
	  [[-1/4, 0, 1/4], [0, 0, 0], [1/4, 0, -1/4]],
	  [[0, 0, 0], [0, 0, 0], [0, 0, 0]]]

PXZ = [[[0, 0, 0], [-1/4, 0, 1/4], [0, 0, 0]],
	  [[0, 0, 0], [0, 0, 0], [0, 0, 0]],
	  [[0, 0, 0], [1/4, 0, -1/4], [0, 0, 0]]]

PYY = [[[0, 0, 0], [0, 0, 0], [0, 0, 0]],
	  [[0, 1, 0], [0, -2, 0], [0, 1, 0]],
	  [[0, 0, 0], [0, 0, 0], [0, 0, 0]]]

PYZ = [[[0, -1/4, 0], [0, 0, 0], [0, 1/4, 0]],
	  [[0, 0, 0], [0, 0, 0], [0, 0, 0]],
	  [[0, 1/4, 0], [0, 0, 0], [0, -1/4, 0]]]

PZZ = [[[0, 0, 0], [0, 1, 0], [0, 0, 0]],
	  [[0, 0, 0], [0, -2, 0], [0, 0, 0]],
	  [[0, 0, 0], [0, 1, 0], [0, 0, 0]]]

total_partial = np.stack((P0,PX,PY,PZ,PXX,PXY,PXZ,PYY,PYZ,PZZ))

P = np.array([[1, 0, 0, 0, 0, 0],
			  [0, 1, 0, 0, 0, 0],
			  [0, 0, 1, 0, 0, 0],
			  [0, 1, 0, 0, 0, 0],
			  [0, 0, 0, 1, 0, 0],
			  [0, 0, 0, 0, 1, 0],
			  [0, 0, 1, 0, 0, 0],
			  [0, 0, 0, 0, 1, 0],
			  [0, 0, 0, 0, 0, 1]])

P_inv = np.linalg.pinv(P)
